[{"url":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/comments/2699750844","pull_request_review_id":3672446911,"id":2699750844,"node_id":"PRRC_kwDOQ4pSo86g6u28","diff_hunk":"@@ -251,6 +251,7 @@ public static Map<String, String> getLoginSearchOptions() {\n \n         public static Predicate<IdentityProviderModel> getLoginPredicate() {\n             return ((Predicate<IdentityProviderModel>) Objects::nonNull)\n+                    .and(idp -> idp.getOrganizationId() == null || Boolean.parseBoolean(idp.getConfig().get(OrganizationModel.BROKER_PUBLIC)))","path":"server-spi/src/main/java/org/keycloak/models/IdentityProviderStorageProvider.java","commit_id":"3e597722a9164d145bc46aa1de5bd714fb6ba357","original_commit_id":"3e597722a9164d145bc46aa1de5bd714fb6ba357","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"**[P0] Avoid NPE when BROKER_PUBLIC config key is absent**\n\n`idp.getConfig().get(OrganizationModel.BROKER_PUBLIC)` can be `null` for org-linked IDPs, and `Boolean.parseBoolean(null)` throws `NullPointerException` (it calls `toLowerCase()` internally). This makes `LoginFilter.getLoginPredicate()` crash on any org-linked IDP missing that config entry.","created_at":"2026-01-16T19:41:27Z","updated_at":"2026-01-16T19:41:27Z","html_url":"https://github.com/droid-code-review-evals/droid-keycloak/pull/2#discussion_r2699750844","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/2","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/comments/2699750844"},"html":{"href":"https://github.com/droid-code-review-evals/droid-keycloak/pull/2#discussion_r2699750844"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/2"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/comments/2699750844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":254,"original_line":254,"side":"RIGHT","author_association":"NONE","original_position":4,"position":4,"subject_type":"line"},{"url":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/comments/2699751116","pull_request_review_id":3672447226,"id":2699751116,"node_id":"PRRC_kwDOQ4pSo86g6u7M","diff_hunk":"@@ -81,22 +90,25 @@ public void update(IdentityProviderModel model) {\n         // for cases the alias is being updated, it is needed to lookup the idp by id to obtain the original alias\n         IdentityProviderModel idpById = getById(model.getInternalId());\n         registerIDPInvalidation(idpById);\n+        registerIDPLoginInvalidationOnUpdate(idpById, model);\n         idpDelegate.update(model);\n     }\n \n     @Override\n     public boolean remove(String alias) {\n         String cacheKey = cacheKeyIdpAlias(getRealm(), alias);\n+        IdentityProviderModel storedIdp = idpDelegate.getByAlias(alias);\n         if (isInvalid(cacheKey)) {\n             //lookup idp by alias in cache to be able to invalidate its internalId","path":"model/infinispan/src/main/java/org/keycloak/models/cache/infinispan/idp/InfinispanIdentityProviderStorageProvider.java","commit_id":"3e597722a9164d145bc46aa1de5bd714fb6ba357","original_commit_id":"3e597722a9164d145bc46aa1de5bd714fb6ba357","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"**[P0] Handle null IDP in remove() invalidation path**\n\n`storedIdp` can be `null` when the alias doesn't exist (or was concurrently removed); `registerIDPLoginInvalidation(storedIdp)` then calls `getLoginPredicate().test(idp)` which will throw due to dereferencing `idp` in the new predicate. This turns a benign `remove(alias)` into a runtime failure.","created_at":"2026-01-16T19:41:32Z","updated_at":"2026-01-16T19:41:32Z","html_url":"https://github.com/droid-code-review-evals/droid-keycloak/pull/2#discussion_r2699751116","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/2","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/comments/2699751116"},"html":{"href":"https://github.com/droid-code-review-evals/droid-keycloak/pull/2#discussion_r2699751116"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/2"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-keycloak/pulls/comments/2699751116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":102,"original_line":102,"side":"RIGHT","author_association":"NONE","original_position":51,"position":51,"subject_type":"line"}]