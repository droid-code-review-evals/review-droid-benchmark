[{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763440","pull_request_review_id":3672463262,"id":2699763440,"node_id":"PRRC_kwDOQ4pS-86g6x7w","diff_hunk":"@@ -550,10 +550,10 @@ export const bookingsRouter = router({\n         const bookingRefsFiltered: BookingReference[] = bookingToReschedule.references.filter(\n           (ref) => !!credentialsMap.get(ref.type)\n         );\n-        bookingRefsFiltered.forEach((bookingRef) => {\n+        bookingRefsFiltered.forEach(async (bookingRef) => {","path":"packages/trpc/server/routers/viewer/bookings.tsx","commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","original_commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"[P1] Await async deletes instead of `forEach(async …)`\n\nThis `forEach(async …)` is fire-and-forget; the reschedule flow can finish before `deleteEvent` completes, and any rejection won’t be caught by the surrounding error handling. Use `for...of` with `await` or build a promise list and `await Promise.all(...)`.","created_at":"2026-01-16T19:46:11Z","updated_at":"2026-01-16T19:46:11Z","html_url":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763440","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763440"},"html":{"href":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763440"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":553,"original_line":553,"side":"RIGHT","author_association":"NONE","original_position":5,"position":5,"subject_type":"line"},{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763441","pull_request_review_id":3672463263,"id":2699763441,"node_id":"PRRC_kwDOQ4pS-86g6x7x","diff_hunk":"@@ -449,7 +449,7 @@ async function handler(req: CustomRequest) {\n         (credential) => credential.id === credentialId\n       );\n       if (calendarCredential) {\n-        const calendar = getCalendar(calendarCredential);\n+        const calendar = await getCalendar(calendarCredential);\n         if (\n           bookingToDelete.eventType?.recurringEvent &&\n           bookingToDelete.recurringEventId &&","path":"packages/features/bookings/lib/handleCancelBooking.ts","commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","original_commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"[P1] Avoid `forEach(async …)` when updating recurring bookings\n\nThis loop is `forEach(async …)`, so the handler can return before the per-credential deletes finish and any rejection won’t propagate. Since this is part of the cancellation side-effects, switch to `for...of` + `await` or `await Promise.all(...)`.","created_at":"2026-01-16T19:46:11Z","updated_at":"2026-01-16T19:46:11Z","html_url":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763441","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763441"},"html":{"href":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763441"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":455,"original_line":455,"side":"RIGHT","author_association":"NONE","original_position":26,"position":26,"subject_type":"line"},{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763446","pull_request_review_id":3672463264,"id":2699763446,"node_id":"PRRC_kwDOQ4pS-86g6x72","diff_hunk":"@@ -122,10 +122,10 @@ const Reschedule = async (bookingUid: string, cancellationReason: string) => {\n       (ref) => !!credentialsMap.get(ref.type)\n     );\n     try {\n-      bookingRefsFiltered.forEach((bookingRef) => {\n+      bookingRefsFiltered.forEach(async (bookingRef) => {","path":"packages/app-store/vital/lib/reschedule.ts","commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","original_commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"[P1] Don’t use `forEach(async …)` for deletions\n\n`Array.forEach` doesn’t await the async callback, so `Reschedule` can return/continue before `deleteEvent`/`deleteMeeting` completes (and errors won’t be caught by the surrounding `try`). Use `for...of` with `await` or collect promises and `await Promise.all(...)`.","created_at":"2026-01-16T19:46:11Z","updated_at":"2026-01-16T19:46:11Z","html_url":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763446","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763446"},"html":{"href":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763446"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":125,"original_line":125,"side":"RIGHT","author_association":"NONE","original_position":5,"position":5,"subject_type":"line"},{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763464","pull_request_review_id":3672463276,"id":2699763464,"node_id":"PRRC_kwDOQ4pS-86g6x8I","diff_hunk":"@@ -122,10 +122,10 @@ const Reschedule = async (bookingUid: string, cancellationReason: string) => {\n       (ref) => !!credentialsMap.get(ref.type)\n     );\n     try {\n-      bookingRefsFiltered.forEach((bookingRef) => {\n+      bookingRefsFiltered.forEach(async (bookingRef) => {","path":"packages/app-store/wipemycalother/lib/reschedule.ts","commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","original_commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"[P1] Don’t use `forEach(async …)` for deletions\n\n`forEach` won’t await the async callback, so calendar/video deletions can run after `Reschedule` proceeds and failures won’t be handled by the `try`. Prefer `for...of` + `await` or `await Promise.all(promises)`.","created_at":"2026-01-16T19:46:11Z","updated_at":"2026-01-16T19:46:11Z","html_url":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763464","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763464"},"html":{"href":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763464"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":125,"original_line":125,"side":"RIGHT","author_association":"NONE","original_position":5,"position":5,"subject_type":"line"},{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763728","pull_request_review_id":3672463635,"id":2699763728,"node_id":"PRRC_kwDOQ4pS-86g6yAQ","diff_hunk":"@@ -28,6 +28,7 @@ export const getCalendarCredentials = (credentials: Array<CredentialPayload>) =>\n         const calendar = getCalendar(credential);","path":"packages/core/CalendarManager.ts","commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","original_commit_id":"e043a5efd872362a3fc146ed0d9ce4393e316c1e","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"[P0] `getCalendarCredentials` stores a Promise in `calendar`\n\n`getCalendar()` is async now, but this function still does `const calendar = getCalendar(credential)` without awaiting, so `calendar` is a `Promise<Calendar|null>`. Any consumer expecting a `Calendar` (or destructuring `{ calendar }`) can break unless all callers are updated to `await item.calendar` and the return type is updated accordingly.","created_at":"2026-01-16T19:46:17Z","updated_at":"2026-01-16T19:46:17Z","html_url":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763728","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763728"},"html":{"href":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/1#discussion_r2699763728"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/1"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":28,"original_line":28,"side":"RIGHT","author_association":"NONE","original_position":1,"position":1,"subject_type":"line"}]