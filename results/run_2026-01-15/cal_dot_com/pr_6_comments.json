[{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763449","pull_request_review_id":3672463267,"id":2699763449,"node_id":"PRRC_kwDOQ4pS-86g6x75","diff_hunk":"@@ -89,6 +99,57 @@ const checkIfIsAvailable = ({\n   const slotEndTime = time.add(eventLength, \"minutes\").utc();\n   const slotStartTime = time.utc();\n \n+  //check if date override for slot exists\n+  let dateOverrideExist = false;\n+\n+  if (\n+    dateOverrides.find((date) => {\n+      const utcOffset = organizerTimeZone ? dayjs.tz(date.start, organizerTimeZone).utcOffset() * -1 : 0;\n+\n+      if (\n+        dayjs(date.start).add(utcOffset, \"minutes\").format(\"YYYY MM DD\") ===\n+        slotStartTime.format(\"YYYY MM DD\")\n+      ) {\n+        dateOverrideExist = true;\n+        if (dayjs(date.start).add(utcOffset, \"minutes\") === dayjs(date.end).add(utcOffset, \"minutes\")) {\n+          return true;\n+        }\n+        if (\n+          slotEndTime.isBefore(dayjs(date.start).add(utcOffset, \"minutes\")) ||\n+          slotEndTime.isSame(dayjs(date.start).add(utcOffset, \"minutes\"))\n+        ) {\n+          return true;\n+        }\n+        if (slotStartTime.isAfter(dayjs(date.end).add(utcOffset, \"minutes\"))) {\n+          return true;\n+        }\n+      }\n+    })\n+  ) {","path":"packages/trpc/server/routers/viewer/slots.ts","commit_id":"3ef328421f60cd096b7676ef7ee7c32b71593049","original_commit_id":"3ef328421f60cd096b7676ef7ee7c32b71593049","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"**[P1] Fix date override equality check (Dayjs objects never equal)**\n\n`dayjs(...) === dayjs(...)` is always false because it compares object identity; this makes the “start==end” branch dead and can misclassify an all-day override. Use `isSame(..., \"minute\")`/`isSame(...)` instead.","created_at":"2026-01-16T19:46:11Z","updated_at":"2026-01-16T19:46:11Z","html_url":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/6#discussion_r2699763449","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/6","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763449"},"html":{"href":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/6#discussion_r2699763449"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/6"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":128,"original_line":128,"side":"RIGHT","author_association":"NONE","original_position":60,"position":60,"subject_type":"line"},{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763669","pull_request_review_id":3672463533,"id":2699763669,"node_id":"PRRC_kwDOQ4pS-86g6x_V","diff_hunk":"@@ -89,6 +99,57 @@ const checkIfIsAvailable = ({\n   const slotEndTime = time.add(eventLength, \"minutes\").utc();\n   const slotStartTime = time.utc();\n \n+  //check if date override for slot exists\n+  let dateOverrideExist = false;\n+\n+  if (\n+    dateOverrides.find((date) => {\n+      const utcOffset = organizerTimeZone ? dayjs.tz(date.start, organizerTimeZone).utcOffset() * -1 : 0;\n+\n+      if (\n+        dayjs(date.start).add(utcOffset, \"minutes\").format(\"YYYY MM DD\") ===\n+        slotStartTime.format(\"YYYY MM DD\")\n+      ) {\n+        dateOverrideExist = true;\n+        if (dayjs(date.start).add(utcOffset, \"minutes\") === dayjs(date.end).add(utcOffset, \"minutes\")) {\n+          return true;\n+        }\n+        if (\n+          slotEndTime.isBefore(dayjs(date.start).add(utcOffset, \"minutes\")) ||\n+          slotEndTime.isSame(dayjs(date.start).add(utcOffset, \"minutes\"))\n+        ) {\n+          return true;\n+        }\n+        if (slotStartTime.isAfter(dayjs(date.end).add(utcOffset, \"minutes\"))) {\n+          return true;\n+        }\n+      }\n+    })\n+  ) {\n+    // slot is not within the date override\n+    return false;\n+  }\n+\n+  if (dateOverrideExist) {\n+    return true;\n+  }\n+\n+  //if no date override for slot exists check if it is within normal work hours\n+  if (\n+    workingHours.find((workingHour) => {\n+      if (workingHour.days.includes(slotStartTime.day())) {\n+        const start = slotStartTime.hour() * 60 + slotStartTime.minute();\n+        const end = slotStartTime.hour() * 60 + slotStartTime.minute();\n+        if (start < workingHour.startTime || end > workingHour.endTime) {\n+          return true;\n+        }\n+      }\n+    })\n+  ) {\n+    // slot is outside of working hours\n+    return false;\n+  }","path":"packages/trpc/server/routers/viewer/slots.ts","commit_id":"3ef328421f60cd096b7676ef7ee7c32b71593049","original_commit_id":"3ef328421f60cd096b7676ef7ee7c32b71593049","user":{"login":"factory-droid[bot]","id":138933559,"node_id":"BOT_kgDOCEf1Nw","avatar_url":"https://avatars.githubusercontent.com/in/358017?v=4","gravatar_id":"","url":"https://api.github.com/users/factory-droid%5Bbot%5D","html_url":"https://github.com/apps/factory-droid","followers_url":"https://api.github.com/users/factory-droid%5Bbot%5D/followers","following_url":"https://api.github.com/users/factory-droid%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/factory-droid%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/factory-droid%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/factory-droid%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/factory-droid%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/factory-droid%5Bbot%5D/repos","events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/factory-droid%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"**[P0] Fix working-hours bounds check (end uses start minutes)**\n\n`const end = ...` repeats `slotStartTime` instead of using the slot end time, so slots that overrun `workingHour.endTime` won’t be rejected. This lets availability leak past working hours (e.g. 60m event starting 16:30 with endTime 17:00).","created_at":"2026-01-16T19:46:15Z","updated_at":"2026-01-16T19:46:15Z","html_url":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/6#discussion_r2699763669","pull_request_url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/6","_links":{"self":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763669"},"html":{"href":"https://github.com/droid-code-review-evals/droid-cal_dot_com/pull/6#discussion_r2699763669"},"pull_request":{"href":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/6"}},"reactions":{"url":"https://api.github.com/repos/droid-code-review-evals/droid-cal_dot_com/pulls/comments/2699763669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":151,"original_line":151,"side":"RIGHT","author_association":"NONE","original_position":83,"position":83,"subject_type":"line"}]