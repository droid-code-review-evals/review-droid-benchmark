{
  "repo": "cal_dot_com",
  "generated_from": "ground_truth_validation/run_2026-01-15",
  "total_bugs": 43,
  "total_false_positives": 2,
  "prs": [
    {
      "pr_number": 1,
      "pr_title": "feat: add calendar cache status and actions (#22532)",
      "bug_count": 5,
      "false_positive_count": 1,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "forEach(async...) fire-and-forget in bookings.tsx reschedule flow",
          "file": "packages/trpc/server/routers/viewer/bookings.tsx",
          "line": 553,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 2,
          "description": "forEach(async...) fire-and-forget in handleCancelBooking recurring booking deletion",
          "file": "packages/features/bookings/lib/handleCancelBooking.ts",
          "line": 459,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 3,
          "description": "forEach(async...) fire-and-forget in vital reschedule",
          "file": "packages/app-store/vital/lib/reschedule.ts",
          "line": 125,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 4,
          "description": "forEach(async...) fire-and-forget in wipemycalother reschedule",
          "file": "packages/app-store/wipemycalother/lib/reschedule.ts",
          "line": 125,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 5,
          "description": "getCalendarCredentials stores Promise<Calendar> without await, breaking type contract",
          "file": "packages/core/CalendarManager.ts",
          "line": 28,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "droid_only",
          "details": ""
        }
      ],
      "original_false_positives": [
        {
          "golden_comment": "Consider adding try-catch around the await to handle import failures gracefully",
          "reasoning": "The code already handles missing/invalid app lookups gracefully with null checks and log.warn. The await on appStore[key] won't throw - it returns undefined for missing keys. This is a speculative/defensive suggestion without a concrete bug."
        }
      ]
    },
    {
      "pr_number": 2,
      "pr_title": "Add guest management functionality to existing bookings",
      "bug_count": 6,
      "false_positive_count": 0,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "TwoFactorAuthAPI.disable() signature breaking change - security/DisableTwoFactorModal.tsx still uses 2 args",
          "file": "apps/web/components/security/DisableTwoFactorModal.tsx",
          "line": 38,
          "severity": "high",
          "bug_type": "unknown",
          "found_by": [
            "droid"
          ],
          "details": ""
        },
        {
          "id": 2,
          "description": "Inconsistent naming: BackupCode.tsx exports function named TwoFactor",
          "file": "apps/web/components/auth/BackupCode.tsx",
          "line": 7,
          "severity": "low",
          "bug_type": "unknown",
          "found_by": [
            "golden"
          ],
          "details": ""
        },
        {
          "id": 3,
          "description": "Misleading error message says 'login' in disable endpoint",
          "file": "apps/web/pages/api/auth/two-factor/totp/disable.ts",
          "line": 48,
          "severity": "low",
          "bug_type": "unknown",
          "found_by": [
            "golden"
          ],
          "details": ""
        },
        {
          "id": 4,
          "description": "Case-sensitive backup code validation (login flow)",
          "file": "packages/features/auth/lib/next-auth-options.ts",
          "line": 130,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": [
            "golden"
          ],
          "details": ""
        },
        {
          "id": 5,
          "description": "Case-sensitive backup code validation (disable flow)",
          "file": "apps/web/pages/api/auth/two-factor/totp/disable.ts",
          "line": 57,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": [
            "golden"
          ],
          "details": ""
        },
        {
          "id": 6,
          "description": "Race condition: concurrent backup code use can bypass one-time-use semantics",
          "file": "packages/features/auth/lib/next-auth-options.ts",
          "line": 127,
          "severity": "high",
          "bug_type": "unknown",
          "found_by": [
            "golden"
          ],
          "details": ""
        }
      ],
      "original_false_positives": []
    },
    {
      "pr_number": 3,
      "pr_title": "SMS workflow reminder retry count tracking",
      "bug_count": 5,
      "false_positive_count": 1,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "Null reference when mainHostDestinationCalendar is undefined in EventManager.ts",
          "file": "packages/core/EventManager.ts",
          "line": 118,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 2,
          "description": "Logic error in updateEvent calendarId selection - find() with falsy externalCalendarId always fails",
          "file": "packages/app-store/googlecalendar/lib/CalendarService.ts",
          "line": 255,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 3,
          "description": "Logic error in deleteEvent calendarId selection - same find() bug as updateEvent",
          "file": "packages/app-store/googlecalendar/lib/CalendarService.ts",
          "line": 315,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 4,
          "description": "Logic inversion in organization creation - slug set when billing enabled instead of disabled",
          "file": "packages/trpc/server/routers/viewer/organizations/create.handler.ts",
          "line": 151,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "golden_only",
          "details": ""
        },
        {
          "id": 5,
          "description": "Calendar interface contract broken - createEvent requires credentialId but implementations don't accept it",
          "file": "packages/app-store/larkcalendar/lib/CalendarService.ts",
          "line": 106,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "golden_only",
          "details": ""
        }
      ],
      "original_false_positives": [
        {
          "golden_comment": "The optional chaining on mainHostDestinationCalendar?.integration is redundant since you already check mainHostDestinationCalendar in the ternary condition.",
          "reasoning": "False positive - the actual code does NOT use optional chaining on mainHostDestinationCalendar.integration. The code accesses .integration directly without optional chaining, which is the actual bug that droid identified."
        }
      ]
    },
    {
      "pr_number": 4,
      "pr_title": "OAuth credential sync and app integration enhancements",
      "bug_count": 2,
      "false_positive_count": 0,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "Unreachable branches in getBaseConditions() - else if (filterConditions) and else branches can never execute",
          "file": "packages/lib/server/service/insightsBooking.ts",
          "line": 77,
          "severity": "low",
          "bug_type": "unknown",
          "found_by": [
            "golden"
          ],
          "details": ""
        },
        {
          "id": 2,
          "description": "Org-level members excluded for orgs without child teams - teamsFromOrg.length guard prevents fetching org memberships",
          "file": "packages/lib/server/service/insightsBooking.ts",
          "line": 157,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": [
            "golden"
          ],
          "details": ""
        }
      ],
      "original_false_positives": []
    },
    {
      "pr_number": 5,
      "pr_title": "Advanced date override handling and timezone compatibility improvements",
      "bug_count": 3,
      "false_positive_count": 0,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "Async forEach pattern - remindersToUpdate.forEach(async...) doesn't await delete operations",
          "file": "packages/trpc/server/routers/viewer/workflows.tsx",
          "line": 575,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": [
            "droid",
            "golden"
          ],
          "details": ""
        },
        {
          "id": 2,
          "description": "NULL referenceId sent to SendGrid API in cron job - query doesn't filter out null referenceIds",
          "file": "packages/features/ee/workflows/api/scheduleEmailReminders.ts",
          "line": 43,
          "severity": "high",
          "bug_type": "unknown",
          "found_by": [
            "droid"
          ],
          "details": ""
        },
        {
          "id": 3,
          "description": "immediateDelete=true path doesn't delete WorkflowReminder record from database",
          "file": "packages/features/ee/workflows/lib/reminders/emailReminderManager.ts",
          "line": 213,
          "severity": "high",
          "bug_type": "unknown",
          "found_by": [
            "golden"
          ],
          "details": ""
        }
      ],
      "original_false_positives": []
    },
    {
      "pr_number": 6,
      "pr_title": "Comprehensive workflow reminder management for booking lifecycle events",
      "bug_count": 2,
      "false_positive_count": 0,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "Dayjs object comparison with === always returns false (dead code for all-day override check)",
          "file": "packages/trpc/server/routers/viewer/slots.ts",
          "line": 114,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 2,
          "description": "Working hours end time calculated using slotStartTime instead of slotEndTime (allows bookings past working hours)",
          "file": "packages/trpc/server/routers/viewer/slots.ts",
          "line": 141,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        }
      ],
      "original_false_positives": []
    },
    {
      "pr_number": 7,
      "pr_title": "feat: convert InsightsBookingService to use Prisma.sql raw queries",
      "bug_count": 9,
      "false_positive_count": 0,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "Webhook header case sensitivity - CALCOM_WEBHOOK_HEADER_NAME with uppercase chars will fail lookup",
          "file": "apps/web/pages/api/webhook/app-credential.ts",
          "line": 24,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "droid_only",
          "details": ""
        },
        {
          "id": 2,
          "description": "Invalid Zod schema syntax - computed keys [z.string().toString()] don't work in z.object()",
          "file": "packages/app-store/_utils/oauth/parseRefreshTokenResponse.ts",
          "line": 7,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 3,
          "description": "Hardcoded 'refresh_token' string when refresh_token is missing from response",
          "file": "packages/app-store/_utils/oauth/parseRefreshTokenResponse.ts",
          "line": 26,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 4,
          "description": "parseRefreshTokenResponse returns safeParse result {success,data,error} instead of parsed data",
          "file": "packages/app-store/_utils/oauth/parseRefreshTokenResponse.ts",
          "line": 29,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 5,
          "description": "Salesforce CalendarService missing prisma import - ReferenceError on token refresh",
          "file": "packages/app-store/salesforce/lib/CalendarService.ts",
          "line": 96,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "droid_only",
          "details": ""
        },
        {
          "id": 6,
          "description": "Salesforce uses stale credentialKey.access_token after refresh instead of refreshed token",
          "file": "packages/app-store/salesforce/lib/CalendarService.ts",
          "line": 103,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "droid_only",
          "details": ""
        },
        {
          "id": 7,
          "description": "zoho-bigin passes credentialId instead of userId to refreshOAuthTokens",
          "file": "packages/app-store/zoho-bigin/lib/CalendarService.ts",
          "line": 93,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "droid_only",
          "details": ""
        },
        {
          "id": 8,
          "description": "refreshOAuthTokens returns fetch Response when sync enabled, but callers expect token object",
          "file": "packages/app-store/_utils/oauth/refreshOAuthTokens.ts",
          "line": 12,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "golden_only",
          "details": ""
        },
        {
          "id": 9,
          "description": "GoogleCalendarService res?.data is undefined when sync endpoint used (Response has no .data)",
          "file": "packages/app-store/googlecalendar/lib/CalendarService.ts",
          "line": 92,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "golden_only",
          "details": ""
        }
      ],
      "original_false_positives": []
    },
    {
      "pr_number": 8,
      "pr_title": "fix: handle collective multiple host on destinationCalendar",
      "bug_count": 3,
      "false_positive_count": 0,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "deleteMany OR clause deletes non-SMS reminders with retryCount > 1",
          "file": "packages/features/ee/workflows/api/scheduleSMSReminders.ts",
          "line": 40,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 2,
          "description": "Race condition in retryCount increment (scheduleSMS failure path)",
          "file": "packages/features/ee/workflows/api/scheduleSMSReminders.ts",
          "line": 188,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 3,
          "description": "Race condition in retryCount increment (catch block path)",
          "file": "packages/features/ee/workflows/api/scheduleSMSReminders.ts",
          "line": 197,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        }
      ],
      "original_false_positives": []
    },
    {
      "pr_number": 9,
      "pr_title": "feat: 2fa backup codes",
      "bug_count": 6,
      "false_positive_count": 0,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "Team admin/owner permission check uses AND instead of OR",
          "file": "packages/trpc/server/routers/viewer/bookings/addGuests.handler.ts",
          "line": 46,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 2,
          "description": "Case sensitivity bypass in email blacklist check",
          "file": "packages/trpc/server/routers/viewer/bookings/addGuests.handler.ts",
          "line": 76,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "golden_only",
          "details": ""
        },
        {
          "id": 3,
          "description": "Email sender receives original guests instead of uniqueGuests",
          "file": "packages/trpc/server/routers/viewer/bookings/addGuests.handler.ts",
          "line": 168,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "golden_only",
          "details": ""
        },
        {
          "id": 4,
          "description": "No deduplication of duplicate emails within input array",
          "file": "packages/trpc/server/routers/viewer/bookings/addGuests.handler.ts",
          "line": 73,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "golden_only",
          "details": ""
        },
        {
          "id": 5,
          "description": "Empty string initialization causes validation UX issues",
          "file": "apps/web/components/dialog/AddGuestsDialog.tsx",
          "line": 31,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 6,
          "description": "Email types swapped - new guests get AttendeeScheduledEmail instead of proper notification",
          "file": "packages/emails/email-manager.ts",
          "line": 542,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "droid_only",
          "details": ""
        }
      ],
      "original_false_positives": []
    },
    {
      "pr_number": 10,
      "pr_title": "Async import of the appStore packages",
      "bug_count": 2,
      "false_positive_count": 0,
      "ground_truth_bugs": [
        {
          "id": 1,
          "description": "BSD/macOS-specific sed -i '' syntax fails on Linux",
          "file": "scripts/test-gcal-webhooks.sh",
          "line": 68,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "both",
          "details": ""
        },
        {
          "id": 2,
          "description": "updateManyByCredentialId with empty data does not trigger @updatedAt",
          "file": "packages/app-store/googlecalendar/lib/CalendarService.ts",
          "line": 1024,
          "severity": "medium",
          "bug_type": "unknown",
          "found_by": "golden_only",
          "details": ""
        }
      ],
      "original_false_positives": []
    }
  ]
}