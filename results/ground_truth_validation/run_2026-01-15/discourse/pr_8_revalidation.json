{
  "pr_number": 8,
  "pr_title": "FIX: proper handling of group memberships",
  "revalidation_date": "2026-01-20",
  "bug_verdicts": [
    {
      "bug_id": 1,
      "original_description": "findMembers returns undefined when name is empty, breaking callers that expect a promise",
      "file": "app/assets/javascripts/discourse/models/group.js",
      "line": 21,
      "original_severity": "medium",
      "original_source": "both",
      "verdict": "modified",
      "verified_file": "app/assets/javascripts/discourse/models/group.js",
      "verified_line": 21,
      "verified_severity": "low",
      "verified_bug_type": "runtime_error",
      "verified_description": "findMembers() returns undefined when group name is blank; any caller that chains (e.g. findMembers().then(...)) will throw a TypeError.",
      "notes": "Confirmed early-return at group.js:21. Current in-tree callers do not chain .then (routes/controllers call it fire-and-forget), so impact appears limited; downgraded severity."
    },
    {
      "bug_id": 2,
      "original_description": "create action ignores alias_level parameter while update handles it, causing data inconsistency",
      "file": "app/controllers/admin/groups_controller.rb",
      "line": 23,
      "original_severity": "medium",
      "original_source": "droid_only",
      "verdict": "confirmed",
      "verified_file": "app/controllers/admin/groups_controller.rb",
      "verified_line": 22,
      "verified_severity": "medium",
      "verified_bug_type": "logic_bug",
      "verified_description": "Admin::GroupsController#create does not apply alias_level from params, but update does; the client sends alias_level in asJSON, so creates cannot set it (defaults), diverging from updates.",
      "notes": "Confirmed: Group#asJSON includes alias_level, create endpoint only sets name+visible, while update sets alias_level when present (groups_controller.rb:37)."
    },
    {
      "bug_id": 3,
      "original_description": "Test uses PUT for remove_member but route expects DELETE, test will fail with routing error",
      "file": "spec/controllers/admin/groups_controller_spec.rb",
      "line": 113,
      "original_severity": "medium",
      "original_source": "both",
      "verdict": "modified",
      "verified_file": "spec/controllers/admin/groups_controller_spec.rb",
      "verified_line": 115,
      "verified_severity": "low",
      "verified_bug_type": "logic_bug",
      "verified_description": "The controller spec invokes remove_member with PUT, but routes define remove_member on DELETE /admin/groups/:group_id/members; the spec doesn't reflect the real HTTP method/route.",
      "notes": "Routes.rb defines DELETE members => groups#remove_member and PUT members => groups#add_members. This does not necessarily fail as a controller spec (it bypasses routing), so the original 'will fail with routing error' claim is inaccurate; adjusted severity and description."
    },
    {
      "bug_id": 4,
      "original_description": "Template iterates over 'members' but controller doesn't have 'members' property, should use 'model.members'",
      "file": "app/assets/javascripts/discourse/templates/group/members.hbs",
      "line": 6,
      "original_severity": "medium",
      "original_source": "droid_only",
      "verdict": "rejected",
      "verified_file": "app/assets/javascripts/discourse/templates/group/members.hbs",
      "verified_line": 6,
      "verified_severity": "medium",
      "verified_bug_type": "logic_bug",
      "verified_description": "",
      "notes": "Not a bug as stated: group templates/controllers in this codebase use ObjectController proxying (e.g., group.hbs uses {{name}} without model.), so {{#each m in members}} can resolve to model.members. group-members route calls model.findMembers(), which sets members on the model."
    },
    {
      "bug_id": 5,
      "original_description": "Pagination next action caps offset at user_count, causing empty last page when offset == user_count",
      "file": "app/assets/javascripts/admin/controllers/admin-group.js.es6",
      "line": 32,
      "original_severity": "medium",
      "original_source": "golden_only",
      "verdict": "confirmed",
      "verified_file": "app/assets/javascripts/admin/controllers/admin-group.js.es6",
      "verified_line": 32,
      "verified_severity": "medium",
      "verified_bug_type": "logic_bug",
      "verified_description": "The next-page offset is capped at user_count (not the last valid start offset), so it can set offset == user_count, yielding an empty page; totalPages is also computed with floor(...)+1, which overcounts when user_count is an exact multiple of limit.",
      "notes": "Example: user_count=100, limit=50 => next sets offset=100, currentPage=3, totalPages=3, but the valid pages are 2; the third page will be empty."
    }
  ],
  "false_positive_verdicts": [],
  "newly_discovered_bugs": []
}
